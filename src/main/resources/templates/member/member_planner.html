<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">

<head>

	<title>ìš´ë™ìº˜ë¦°ë”</title>
	<link rel="icon" th:href="@{/img/fitlink.png}" type="image/png" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/5.3.3/litera/bootstrap.min.css"
		integrity="sha512-TUtnNUXMMWp2IALAR9t2z1vuorOUQL4dPWG3J9ANInEj6xu/rz5fzni/faoEGzuqeY1Z1yGD6COYAW72oiDVYA=="
		crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" th:href="@{/css/common.css}">
	<link rel="stylesheet" th:href="@{/css/detail_hj.css}" />
	<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
		crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-1.2.0.js"></script>
	<style>
		/* íŒì—… ìŠ¤íƒ€ì¼ */
		.popup {
			display: none;
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			background: white;
			padding: 20px;
			box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3);
			border-radius: 8px;
			width: 400px;
			z-index: 10;
		}

		.popup h3 {
			margin-top: 0;
			font-size: 20px;
		}

		.popup .close {
			cursor: pointer;
			float: right;
			color: red;
			font-weight: bold;
		}

		.popup .event-list {
			list-style: none;
			padding: 0;
		}

		.popup .event-list li {
			margin: 5px 0;
			padding: 5px;
			background: #f1f1f1;
			cursor: pointer;
		}

		.popup .event-list li.completed {
			text-decoration: line-through;
			/* ì¼ì • ì™„ë£Œ ì‹œ ë°‘ì¤„ */
			color: gray;
		}

		.popup button {
			margin-top: 10px;
			width: 100%;
		}

		.fc-direction-ltr {
			direction: ltr;
			text-align: left;
			width: 100%;
			min-width: 1000px;
			min-height: 600px;
		}
	</style>

</head>

<body>
	<!-- ë¡œë”© í™”ë©´ -->
	<div id="loadingOverlay">
		<div class="spinner"></div>
		<p>ì¼ì •ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
	</div>

	<div th:insert="~{layouts/header :: header}"></div>

	<main class="main container" id="mypage_pg">
		<div class="sidebar">
			<div class="header">
				<h2 style="font-size: 20px;">ë§ˆì´í˜ì´ì§€</h2>
				<!-- <button class="btn btn-danger" onclick="location.href='/member/logout'">ë¡œê·¸ì•„ì›ƒ</button> -->
			</div>

			<div class="btn_wrap">
				<div class="header" th:if="${member.memIsmanager == false}">
					<a href="/member/mypage">ë‚˜ì˜ì •ë³´</a> <a href="/member/reservation">ë‚˜ì˜ì‹œì„¤ì˜ˆì•½</a>
					<a href="/member/member_planner" class="active">ìš´ë™ìº˜ë¦°ë”</a> <a href="/member/club_myclub">ë‚˜ì˜í´ëŸ½ê´€ë¦¬</a>
					<a href="/member/club_joinclub">ê°€ì…í•œí´ëŸ½</a>
				</div>

				<div class="header" th:if="${member.memIsmanager == true}">
					<a href="/member/mypage" class="active">ë‚˜ì˜ì •ë³´</a>
				</div>



				<div style="align-items: center;">
					<div
						style="cursor: pointer; display: inline-flex; gap: 5px; margin: 10px 0; justify-content: space-between; width: 100%;">
						<p style="font-size: 16px; font-weight: bold; margin: 0;">FITPAY</p>
						<p style="font-size: 16px; font-weight: bold; color: #333; margin: 0;">
							<span th:text="${#numbers.formatInteger(#authentication.principal.memMoney, 0, 'COMMA')}"
								id="memMoney"></span>ì›
							<input type="number" id="memMoney_ip" name="memMoney" class="blind">
						</p>
					</div>
					<div style="display: inline-flex; gap: 5px; width: 100%">
						<button class="btn btn-primary" id="fitpayCharge" style="width: 50%">ì¶©ì „</button>
						<button class="btn btn-success" id="payList" style="width: 50%">ë‚´ì—­</button>
					</div>
				</div>
			</div>

			<div th:insert="~{layouts/charge_popup :: charge_popup}"></div>
			<div th:insert="~{layouts/pay_list :: pay_list}"></div>


		</div>
		<div class="main">
			<h2 class="blind">ìš´ë™ ìº˜ë¦°ë”</h2>
			<div style="padding: 10px;
			background-color: #f6f6f6;
			margin-bottom: 30px;
			font-size: 13px;
			border-radius: 10px;">
				<p>* ìš´ë™ìº˜ë¦°ë”ì—ì„œ [ì‹œì„¤ì˜ˆì•½] ì¼ì •ì„ ì‚­ì œí•  ê²½ìš°, ì‹œì„¤ì˜ˆì•½ì´ ìë™ìœ¼ë¡œ ì·¨ì†Œë©ë‹ˆë‹¤.</p>
				<p>* ìš´ë™ìº˜ë¦°ë”ì—ì„œ [í´ëŸ½] ì¼ì •ì„ ì‚­ì œí•  ê²½ìš°, í•´ë‹¹ ì¼ì • ì°¸ê°€ê°€ ìë™ìœ¼ë¡œ ì·¨ì†Œë©ë‹ˆë‹¤.</p>
			</div>
			<div id="calendar"></div>
		</div>


		<!-- ì¼ì • ëª©ë¡ íŒì—… -->
		<div id="eventPopup" class="popup">
			<span class="close" onclick="closePopup()">X</span>
			<h3 id="popupDate"></h3>
			<ul id="eventList" class="event-list"></ul>
			<button onclick="addEventPopup()" class="btn btn-primary">+ ì¼ì • ì¶”ê°€</button>
		</div>

		<!-- ì¼ì • ì¶”ê°€ íŒì—… -->
		<div id="eventAddPopup" class="popup">
			<div class="popup-content">
				<span class="close" onclick="closeAddPopup()">X</span>
				<h3>ì¼ì • ì¶”ê°€</h3>
				<input type="hidden" id="popupMemId" value="">
				<p id="popupDateDisplay"></p>
				<p><label style="margin-top:10px;">ì œëª©:</label> <input type="text" class="form-control"
						id="popupPlanName" placeholder="ì¼ì • ì œëª© ì…ë ¥"> </p>
				<p><label style="margin-top:10px;">ë‚´ìš©:</label>
					<textarea id="popupPlanText" class="form-control" placeholder="ì¼ì • ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
				</p>
				<div class="popup-buttons">
					<button onclick="addEvent()" class="btn btn-primary">ë“±ë¡</button>
					<!-- <button onclick="closeAddPopup()" class="btn btn-secondary">ì·¨ì†Œ</button> -->
				</div>
			</div>
		</div>


		<!-- ì¼ì • ìƒì„¸ë³´ê¸° íŒì—… -->
		<div id="eventDetailPopup" class="popup">
			<span class="close" onclick="closeDetailPopup()">X</span>
			<h3 id="detailTitle"></h3>
			<p id="detailContent"></p>

			<div class="popup-buttons">
				<button id="listEventButton" class="btn btn-primary">ëª©ë¡ ë³´ê¸°</button>
				<!-- <button id="completeEventButton">ì¼ì • ì™„ë£Œ</button> -->
				<button id="deleteEventButton" class="btn btn-danger">ì‚­ì œ</button>
			</div>
		</div>
	</main>

	<div th:insert="~{layouts/footer :: footer}"></div>
	<!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ IDë¥¼ ìˆ¨ê²¨ì§„ ì…ë ¥ í•„ë“œë¡œ ì €ì¥ -->
	<input type="hidden" id="loggedInMemId" th:value="${#authentication.principal.memId}">


	<script th:inline="javascript">
		
		document.addEventListener('DOMContentLoaded', function () {

			/* ì‹œì„¤ ì˜ˆì•½ ì„±ê³µ ë©”ì‹œì§€ */
			let result = /*[[${result}]]*/ null;
			if (result) {
				alert(result);
			}

			/* ì˜ˆì•½ ì·¨ì†Œ ì„±ê³µ ë©”ì‹œì§€ */
			let cancelResult = /*[[${cancelResult}]]*/ null;
			if (cancelResult) {
				alert(cancelResult);
			}


			let calendarEl = document.getElementById('calendar');
			let memId = document.getElementById("loggedInMemId").value; // ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ID ê°€ì ¸ì˜¤ê¸°

			let calendar = new FullCalendar.Calendar(calendarEl, {
				initialView: 'dayGridMonth',
				events: function (fetchInfo, successCallback, failureCallback) {
					fetch(`/planner/list?memId=` + encodeURIComponent(memId))  // âœ… `/list` APIë¡œ ë³€ê²½
						.then(response => {
							if (!response.ok) {
								throw new Error("ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: " + response.status);
							}
							return response.json();
						})
						.then(events => {
							console.log("ğŸ“Œ ë¶ˆëŸ¬ì˜¨ ì¼ì • ë°ì´í„°:", events); // âœ… ë°ì´í„° í™•ì¸ìš© ë¡œê·¸ ì¶”ê°€
							let formattedEvents = events.map(event => ({
								id: event.id,  // `id` í‚¤ê°€ ë§ëŠ”ì§€ í™•ì¸
								title: event.title, // âœ… ì¼ì • ì œëª©ì´ ë‚ ì§œ ì¹¸ì— í‘œì‹œë¨
								start: event.start, // âœ… FullCalendarì—ì„œ ë‚ ì§œ ì¸ì‹ í™•ì¸
								color: event.color,
								extendedProps: {
									planText: event.planText,
									planIschk: event.planIschk,
									planNo: event.planNo,  // âœ… ìƒì„¸ì •ë³´ì—ì„œ ì‚¬ìš©ë  `planNo`
									memId: event.memId,      // âœ… ì‚¬ìš©ì ID ì¶”ê°€ (í•„ìš”ì‹œ)
									reservationCode: event.reservationCode,
									clubCode: event.clubCode
								}

							}));
							console.log("ğŸ“Œ ë³€í™˜ëœ ì´ë²¤íŠ¸ ë°ì´í„°:", formattedEvents); // âœ… ë³€í™˜ëœ ë°ì´í„° í™•ì¸
							successCallback(formattedEvents);
							// âœ… ëª¨ë“  ë°ì´í„°ê°€ ë¡œë“œëœ í›„ ë¡œë”© í™”ë©´ ìˆ¨ê¸°ê¸°
							document.getElementById("loadingOverlay").style.display = "none";

						})
						.catch(error => {
							console.error("ğŸš¨ ì´ë²¤íŠ¸ ë¡œë”© ì˜¤ë¥˜:", error);
							failureCallback(error);
						});
				},
				dateClick: function (info) {
					openPopup(info.dateStr);
				},
				eventClick: function (info) {
					console.log("ğŸ“Œ í´ë¦­í•œ ì´ë²¤íŠ¸ ë°ì´í„°:", info.event);

					// í•œêµ­(KST) ê¸°ì¤€ ë‚ ì§œ ë³€í™˜
					let localDate = new Date(info.event.start);
					let planDate = localDate.toISOString().split("T")[0]; // âœ… ê¸°ì¡´ ë°©ì‹ (UTC ë‚ ì§œ)
					let correctedPlanDate = localDate.toLocaleDateString('ko-KR', {
						year: 'numeric',
						month: '2-digit',
						day: '2-digit'
					}).replace(/\. /g, '-').replace('.', ''); // âœ… KST ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ë³€í™˜

					let selectedEvent = {
						planNo: info.event.id,
						planName: info.event.title,
						planDate: correctedPlanDate,
						planText: info.event.extendedProps.planText,
						planIschk: info.event.extendedProps.planIschk,
						reservationCode: info.event.extendedProps.reservationCode, // âœ… ì¶”ê°€
						clubCode: info.event.extendedProps.clubCode, // âœ… ì¶”ê°€
						memId: info.event.extendedProps.memId // âœ… ì¶”ê°€
					};


					console.log("ğŸ“Œ ë³€í™˜ëœ ì´ë²¤íŠ¸ ë°ì´í„°:", selectedEvent);
					showDetail(selectedEvent);
				}





			});

			calendar.render();
		});


		//ğŸ“Œ ì¼ì • ëª©ë¡ íŒì—… ì—´ê¸° (ë‚ ì§œ í´ë¦­ ì‹œ)
		function openPopup(date) {
			document.getElementById("popupDate").innerText = `ğŸ“… ${date} ì¼ì •`;
			document.getElementById("eventList").innerHTML = "";

			let memId = document.getElementById("loggedInMemId").value; // ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ID ê°€ì ¸ì˜¤ê¸°
			let planDate = date;

			fetch(`/planner/date?memId=${encodeURIComponent(memId)}&planDate=${planDate}`)
				.then(response => {
					if (!response.ok) {
						throw new Error("ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: " + response.status);
					}
					return response.json();
				})
				.then(events => {
					let eventList = document.getElementById("eventList");
					eventList.innerHTML = ""; // ê¸°ì¡´ ëª©ë¡ ì´ˆê¸°í™”

					events.forEach(event => {
						let li = document.createElement("li");
						li.setAttribute("data-planNo", event.planNo); // ğŸ“Œ ì¼ì • ID ì €ì¥
						li.classList.add("event-item"); // âœ… í´ë˜ìŠ¤ ì¶”ê°€ (ì´ë²¤íŠ¸ ë°”ì¸ë”©ì„ ìœ„í•´)

						// ğŸ“Œ ì²´í¬ë°•ìŠ¤ ì¶”ê°€
						let checkbox = document.createElement("input");
						checkbox.type = "checkbox";
						checkbox.checked = event.planIschk; // ì¼ì • ì™„ë£Œ ì—¬ë¶€ ë°˜ì˜
						checkbox.classList.add("event-checkbox"); // âœ… ì²´í¬ë°•ìŠ¤ í´ë˜ìŠ¤ ì¶”ê°€
						checkbox.style.marginRight = "10px";

						// ğŸ“Œ ì¼ì • ì œëª© ì¶”ê°€
						let span = document.createElement("span");
						span.innerText = event.planName;

						// âœ… ì²´í¬ë°•ìŠ¤ì™€ ì œëª©ì„ liì— ì¶”ê°€
						li.appendChild(checkbox);
						li.appendChild(span);

						// âœ… ì™„ë£Œëœ ì¼ì •ì— ë°‘ì¤„ ì¶”ê°€
						if (event.planIschk) {
							li.classList.add("completed");
						} else {
							li.classList.remove("completed");
						}

						// âœ… ğŸ“Œ `li` í´ë¦­ ì‹œ showDetail() ì‹¤í–‰ (ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€)
						li.addEventListener("click", function (e) {
							// ì²´í¬ë°•ìŠ¤ë¥¼ í´ë¦­í•œ ê²½ìš° `showDetail()` ì‹¤í–‰ X
							if (e.target.tagName.toLowerCase() === "input") return;
							showDetail(event);
						});
						eventList.appendChild(li);

					});
				})
				.catch(error => {
					console.error("ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:", error);
					alert(`ì¼ì •ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`);
				});

			document.getElementById("eventPopup").style.display = "block";
		}

		// ğŸ“Œ ì¼ì • ì™„ë£Œ ìƒíƒœ ì—…ë°ì´íŠ¸ (ì„œë²„ì— ì €ì¥)
		function toggleCompletion(planNo, isChecked) {
			console.log(`âœ… ì„œë²„ì— ì „ë‹¬: ì¼ì • ${planNo}, ì™„ë£Œ ìƒíƒœ: ${isChecked}`); // âœ… ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€
			$.ajax({
				type: "PUT",
				url: "/planner/updateIschk",
				contentType: "application/json",
				data: JSON.stringify({
					planNo: planNo,
					planIschk: isChecked // ì²´í¬ ì—¬ë¶€ì— ë”°ë¼ true/false ì—…ë°ì´íŠ¸
				}),
				success: function () {
					console.log(`âœ… ì¼ì • (${planNo}) ì™„ë£Œ ìƒíƒœ ì„œë²„ ë°˜ì˜ ì™„ë£Œ: ${isChecked}`);
				},
				error: function () {
					alert("ì¼ì • ì™„ë£Œ ìƒíƒœ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
				}
			});
		}

		// âœ… ì²´í¬ë°•ìŠ¤ í´ë¦­ ì‹œ ì¼ì • ì™„ë£Œ ìƒíƒœ ë³€ê²½ (ì´ë²¤íŠ¸ ìœ„ì„ ë°©ì‹)
		$(document).on("change", ".event-checkbox", function () {
			let listItem = $(this).closest(".event-item"); // ì²´í¬ë°•ìŠ¤ê°€ ì†í•œ li ê°€ì ¸ì˜¤ê¸°
			let planNo = listItem.attr("data-planNo"); // ì¼ì • ë²ˆí˜¸ ê°€ì ¸ì˜¤ê¸°
			let isChecked = $(this).prop("checked"); // ì²´í¬ ì—¬ë¶€ ê°€ì ¸ì˜¤ê¸°

			console.log(`ğŸ“Œ ì²´í¬ë°•ìŠ¤ í´ë¦­: ì¼ì • ${planNo}, ìƒíƒœ: ${isChecked}`); // âœ… ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€

			// âœ… ì²´í¬ë°•ìŠ¤ ìƒíƒœì— ë”°ë¼ ì™„ë£Œ/í•´ì œ ìŠ¤íƒ€ì¼ ì ìš©
			if (isChecked) {
				listItem.addClass("completed");
			} else {
				listItem.removeClass("completed");
			}

			// âœ… ì„œë²„ì— ì™„ë£Œ ìƒíƒœ ì—…ë°ì´íŠ¸
			toggleCompletion(planNo, isChecked);
		});


		// ì¼ì • ì¶”ê°€ íŒì—… ì—´ê¸°
		function addEventPopup() {
			let memId = document.getElementById("loggedInMemId").value;
			let planDate = document.getElementById("popupDate").innerText.replace("ğŸ“… ", "").replace(" ì¼ì •", "");

			document.getElementById("popupMemId").value = memId;
			document.getElementById("popupDateDisplay").innerText = "ë‚ ì§œ: " + planDate;
			document.getElementById("popupPlanName").value = "";
			document.getElementById("popupPlanText").value = "";

			document.getElementById("eventAddPopup").style.display = "block";
		}

		// íŒì—… ë‹«ê¸°
		function closeAddPopup() {
			document.getElementById("eventAddPopup").style.display = "none";
		}



		// ì¼ì • ì¶”ê°€ AJAX ìš”ì²­
		function addEvent() {
			let memId = document.getElementById("popupMemId").value;
			let planDate = document.getElementById("popupDate").innerText.replace("ğŸ“… ", "").replace(" ì¼ì •", "");
			let planName = document.getElementById("popupPlanName").value;
			let planText = document.getElementById("popupPlanText").value;

			if (planName.trim() === "") {
				alert("ì¼ì • ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.");
				return;
			}

			$.ajax({
				type: "POST",
				url: "/planner/add",
				contentType: "application/json",
				data: JSON.stringify({
					memId: memId,
					planDate: planDate,
					planName: planName,
					planText: planText,
					// color: event.color,
					planIschk: false
				}),
				success: function () {
					alert("ì¼ì •ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!");
					closePopup(); // íŒì—… ë‹«ê¸°
					location.reload(); // ìƒˆë¡œê³ ì¹¨
				}
			});
		};

		// í´ëŸ½ì¼ì • ê°€ì ¸ì˜¤ê¸°
		/* function convertReservationsToPlans() {
		let memId = document.getElementById("popupMemId").value; // í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ID
	
		$.ajax({
			type: "POST",
			url: "/planner/convertReservations",
			data: { memId: memId },
			success: function (response) {
				alert(response); // ì„±ê³µ ë©”ì‹œì§€ ì¶œë ¥
				// location.reload(); // ìƒˆë¡œê³ ì¹¨
			},
			error: function (xhr, status, error) {
				alert("ì˜¤ë¥˜ ë°œìƒ: " + xhr.responseText);
			}
		});
	};
	
	window.onload = function () {
		convertReservationsToPlans();
	}; */



		// ì¼ì • ìƒì„¸ ë³´ê¸°
		let selectedEvent = {}; // âœ… ì „ì—­ ë³€ìˆ˜ ì„ ì–¸

		function showDetail(event) {
			selectedEvent = event; // âœ… ì „ì—­ ë³€ìˆ˜ì— event ë°ì´í„° ì €ì¥

			document.getElementById("detailTitle").innerText = event.planName;
			document.getElementById("detailContent").innerText = event.planText;

			document.getElementById("deleteEventButton").onclick = function () {
				console.log(selectedEvent.planNo, selectedEvent.reservationCode, selectedEvent.clubCode, selectedEvent.memId);
				deleteEvent(selectedEvent.planNo, selectedEvent.reservationCode, selectedEvent.clubCode, selectedEvent.memId);
			};

			document.getElementById("eventDetailPopup").style.display = "block";

			document.getElementById("listEventButton").onclick = function () {
				console.log("ğŸ“Œ ëª©ë¡ ë³´ê¸° ë²„íŠ¼ í´ë¦­ - í•´ë‹¹ ë‚ ì§œ:", event.planDate);
				closeDetailPopup();
				openPopup(event.planDate);
			};
		}


		// ì¼ì • ì™„ë£Œ ì²˜ë¦¬
		/* function completeEvent(planNo) {
			$.ajax({
				type: "PUT",
				url: "/planner/updateIschk",
				contentType: "application/json",
				data: JSON.stringify({
					planNo: planNo,
					planIschk: true
				}),
				success: function () {
					alert("ìš´ë™ ì¼ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
					let listItem = document.querySelector(`[data-planNo='${planNo}']`);
					if (listItem) {
						listItem.classList.add("completed"); // ë°‘ì¤„ ì¶”ê°€
					}
					closeDetailPopup();
				}
			});
		} */

		// DELETE ìš”ì²­ì„ bodyì— ë°ì´í„° í¬í•¨í•´ì„œ ë³´ë‚´ê¸°
		function deleteEvent(planNo, reservationCode, clubCode, memId) {
			if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
				$.ajax({
					type: "DELETE",
					url: "/planner/delete",
					contentType: "application/json",
					data: JSON.stringify({
						planNo: Number(planNo),  // âœ… ìˆ«ìë¡œ ë³€í™˜ í›„ ì „ì†¡
						reservationCode: reservationCode,
						clubCode: clubCode,
						memId: memId
					}),
					success: function () {
						alert("ì¼ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!");
						location.reload();
					},
					error: function (xhr) {
						alert("ğŸš¨ ì‚­ì œ ì‹¤íŒ¨: " + xhr.responseText);
					}
				});

			}
		}


		// íŒì—… ë‹«ê¸°
		function closePopup() {
			document.getElementById("eventPopup").style.display = "none";
		}

		function closeDetailPopup() {
			document.getElementById("eventDetailPopup").style.display = "none";
		}
	</script>

</body>

</html>